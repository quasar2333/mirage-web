# Mirage 镜像站

Mirage 镜像站是一个功能丰富的 AI 聊天应用程序，旨在提供无缝、可定制的对话体验。该项目利用尖端的网络技术和强大的后端 API，为用户提供了一个与 AI 模型进行交互的直观平台。无论您是希望利用 AI 完成日常任务的用户，还是有兴趣探索和扩展应用程序功能的开发人员，本文档都将为您提供全面的指南。

该应用程序的核心是其与 Google Gemini API 的集成，该 API 使用户能够利用强大的语言模型进行各种任务。从起草电子邮件和编写代码到集思广益和学习新主题，Mirage 镜像站都是一个多功能的工具，可满足广泛的需求。

## 主要功能

*   **响应式和直观的界面**：该应用程序采用现代化的响应式设计，可在从台式机到移动设备的各种设备上提供无缝的用户体验。
*   **可定制的聊天体验**：用户可以根据自己的喜好定制聊天体验，包括调整模型参数、选择不同的主题以及配置系统指令。
*   **聊天记录和会话管理**：Mirage 镜像站具有强大的聊天记录系统，允许用户保存、重命名、固定和整理他们的对话。
*   **多媒体支持**：该应用程序支持文件上传，允许用户在对话中包含图像、文档和其他文件。
*   **代码高亮和渲染**：开发人员会喜欢代码块的语法高亮功能，使阅读和理解代码片段变得更加容易。该应用程序还支持 Mermaid 图，用于在聊天中可视化图表和流程图。
*   **导出和共享**：用户可以轻松地将他们的聊天记录导出为各种格式，包括 PNG、HTML 和 TXT，从而可以轻松地与他人共享或存档重要的对话。
*   **可安装的 PWA**：Mirage 镜像站可以作为渐进式 Web 应用程序 (PWA) 安装，提供类似于本机的体验和离线访问功能。
*   **全面的设置管理**：该应用程序提供了一个详细的设置模式，用户可以在其中配置他们的 API 密钥、管理应用程序数据以及自定义应用程序的行为。

## 技术栈

Mirage 镜像站建立在现代技术栈之上，经过精心挑选，以确保高性能、可扩展性和可维护性。

### 前端

*   **React**：一个用于构建用户界面的流行 JavaScript 库，以其基于组件的架构和声明式语法而闻名。
*   **TypeScript**：JavaScript 的超集，它为语言添加了静态类型，从而提高了代码质量和可维护性。
*   **Vite**：一个现代化的前端构建工具，可提供极快的开发服务器和优化的构建过程。
*   **Lucide React**：一套美观一致的图标，用于增强应用程序的视觉吸引力。
*   **Marked 和 DOMPurify**：用于将 Markdown 转换为 HTML 并对其进行清理，以防止跨站脚本 (XSS) 攻击。
*   **Highlight.js**：一个用于突出显示代码块语法的库，支持多种语言。
*   **Mermaid**：一个用于从文本生成图表和流程图的库，与聊天界面集成。
*   **html2canvas**：一个用于将聊天记录导出为 PNG 图像的库。

### API

*   **Google Gemini API**：为应用程序的 AI 功能提供支持的后端 API，可访问强大的语言模型。

## 功能

### 聊天界面

聊天界面是应用程序的核心，用户可以在其中与 AI 模型进行交互。它包括以下功能：

*   **消息输入**：一个文本区域，用户可以在其中键入和发送消息。
*   **文件上传**：一个用于将文件附加到消息的按钮，支持各种文件类型。
*   **模型选择**：一个下拉菜单，用于选择要用于对话的 AI 模型。
*   **停止生成**：一个用于在 AI 模型生成响应时停止的按钮。
*   **编辑和删除消息**：用于编辑或删除先前发送的消息的选项。

### 聊天记录

聊天记录侧边栏提供了管理对话的全面解决方案。

*   **会话列表**：所有已保存聊天会话的列表，按日期排序。
*   **固定会话**：用于将重要会话固定到列表顶部的选项。
*   **重命名和删除**：用于重命名或删除会话的选项。
*   **分组**：用于将相关会话组织到可折叠组中的功能。

### 设置

设置模式允许用户根据自己的喜好配置应用程序。

*   **API 配置**：用于输入和管理其 Google Gemini API 密钥的部分。
*   **外观**：用于在不同主题之间进行选择和调整字体大小的选项。
*   **聊天行为**：用于配置模型参数、系统指令和其他聊天相关设置的设置。
*   **数据管理**：用于导出和导入应用程序设置以及清除缓存的选项。

### 部署

Mirage 镜像站可以部署在各种平台上，包括本地环境和云提供商。部署过程非常简单，需要最少的配置。

#### 本地部署

要在本地运行应用程序，请按照以下步骤操作：

1.  **先决条件**：确保您的系统上安装了 Node.js。
2.  **安装依赖项**：运行 `npm install` 来安装所有必需的依赖项。
3.  **配置 API 密钥**：在 `.env.local` 文件中将 `GEMINI_API_KEY` 设置为您的 Gemini API 密钥。
4.  **运行应用程序**：运行 `npm run dev` 来启动开发服务器。

#### 生产部署

要为生产构建应用程序，请运行 `npm run build`。此命令将生成一个 `dist` 目录，其中包含可部署到任何静态托管提供商（例如 Vercel、Netlify 或 GitHub Pages）的优化静态文件。

## 项目结构

```
/
|-- components/
|   |-- chat/
|   |-- message/
|   |-- settings/
|   |-- shared/
|   |-- AuthScreen.tsx
|   |-- ChatInput.tsx
|   |-- ...
|-- constants/
|   |-- appConstants.ts
|   |-- ...
|-- hooks/
|   |-- useChat.ts
|   |-- ...
|-- services/
|   |-- api/
|   |-- geminiService.ts
|   |-- ...
|-- utils/
|   |-- apiUtils.ts
|   |-- ...
|-- App.tsx
|-- index.tsx
|-- package.json
|-- ...
```

*   **`components/`**：此目录包含应用程序中使用的所有 React 组件。它被进一步组织成子目录，以实现更好的模块化。
    *   **`chat/`**：与聊天输入和相关功能相关的组件。
    *   **`message/`**：用于渲染消息及其内容的组件。
    *   **`settings/`**：与应用程序设置模式相关的组件。
    *   **`shared/`**：可在整个应用程序中重复使用的通用组件。
*   **`constants/`**：此目录包含在整个应用程序中使用的常量值，例如应用程序常量、模型参数和主题。
*   **`hooks/`**：此目录包含自定义 React 挂钩，这些挂钩封装了应用程序中的复杂逻辑，例如管理聊天状态、处理用户设置和与 API 交互。
*   **`services/`**：此目录包含负责与外部 API（例如 Google Gemini API）交互的服务。它抽象了 API 通信的细节，使应用程序的其余部分更易于维护。
*   **`utils/`**：此目录包含在整个应用程序中使用的实用程序函数。这些函数执行各种任务，例如格式化数据、处理翻译和管理 UI 逻辑。
*   **`App.tsx`**：应用程序的主要组件，它将所有其他组件组合在一起并管理应用程序的整体状态。
*   **`index.tsx`**：应用程序的入口点，它将 `App` 组件渲染到 DOM 中。
*   **`package.json`**：此文件包含项目的元数据，包括其依赖项、脚本和版本信息。

## 核心组件和挂钩

### 组件

*   **`App.tsx`**：如前所述，这是将所有内容整合在一起的根组件。它负责管理应用程序级状态，例如身份验证、主题和模式可见性。
*   **`ChatInput.tsx`**：此组件提供用户键入消息、附加文件和与各种聊天相关操作（例如发送消息、停止生成和切换模型）进行交互的界面。
*   **`MessageList.tsx`**：此组件负责渲染消息列表。它处理滚动、代码块的语法高亮以及 Mermaid 图的渲染。
*   **`HistorySidebar.tsx`**：此组件显示聊天会话列表，允许用户在不同的对话之间切换、管理其会话并创建新聊天。
*   **`SettingsModal.tsx`**：此模式包含各种应用程序设置，允许用户自定义其体验。它分为几个部分，以便于导航。
*   **`Header.tsx`**：页眉组件显示当前聊天模型的名称，并提供用于创建新聊天、打开设置和切换历史记录侧边栏的控件。

### 挂钩

*   **`useChat.ts`**：这是应用程序中最重要的挂钩之一。它管理与聊天功能相关的所有状态和逻辑，包括发送和接收消息、管理聊天记录以及处理文件上传。
*   **`useAppSettings.ts`**：此挂钩负责管理用户的应用程序设置。它处理从本地存储加载设置、更新设置以及在整个应用程序中提供设置。
*   **`useAppUI.ts`**：此挂钩管理与应用程序 UI 相关的状态，例如模式的可见性和历史记录侧边栏的打开/关闭状态。
*   **`useAppEvents.ts`**：此挂钩处理各种应用程序级事件，例如安装 PWA、导入/导出设置以及处理键盘快捷键。
*   **`useModels.ts`**：此挂钩负责从 Gemini API 获取可用模型列表，并管理与模型选择相关的状态。

## 部署

本节提供有关如何部署 Mirage 镜像站应用程序的详细说明。无论您是希望在本地计算机上运行它的用户，还是希望将其部署到 Web 服务器的开发人员，这些说明都将指导您完成整个过程。

###面向用户的部署（本地运行）

如果您是有兴趣在自己的计算机上运行该应用程序的用户，请按照以下步骤操作。此方法非常适合在不进行任何代码修改的情况下使用该应用程序。

#### 先决条件

*   **Node.js**：您的系统上必须安装 Node.js。您可以从[官方网站](https://nodejs.org/)下载。
*   **Gemini API 密钥**：您需要一个 Google Gemini API 密钥才能使用该应用程序的 AI 功能。您可以从 [Google AI Studio](https://aistudio.google.com/) 获取一个。

#### 说明

1.  **下载项目**：从项目的 GitHub 存储库下载最新的代码。您可以将其克隆或下载为 ZIP 文件。
2.  **安装依赖项**：打开终端或命令提示符，导航到项目目录，然后运行以下命令：
    ```bash
    npm install
    ```
3.  **配置 API 密钥**：在项目目录中，创建一个名为 `.env.local` 的新文件。在此文件中，添加以下行，将 `YOUR_API_KEY` 替换为您的实际 Gemini API 密钥：
    ```
    GEMINI_API_KEY=YOUR_API_KEY
    ```
4.  **运行应用程序**：运行以下命令来启动应用程序：
    ```bash
    npm run dev
    ```
5.  **访问应用程序**：在您的网络浏览器中打开终端中显示的 URL（通常是 `http://localhost:5173`）。

### 面向开发人员的部署（生产）

如果您是希望将该应用程序部署到 Web 服务器或云平台的开发人员，请按照以下步骤操作。此方法涉及为生产构建应用程序并将其部署为静态站点。

#### 先决条件

*   **Node.js 和 npm**：确保您的开发计算机上安装了 Node.js 和 npm。
*   **托管平台**：选择一个托管平台来部署您的静态站点。流行的选项包括 Vercel、Netlify、GitHub Pages 和 AWS S3。
*   **Git**：建议使用 Git 进行版本控制和轻松部署。

#### 说明

1.  **为生产构建**：在您的项目目录中，运行以下命令来为生产构建应用程序：
    ```bash
    npm run build
    ```
    此命令将创建一个 `dist` 目录，其中包含优化的静态文件，可用于部署。
2.  **部署到托管平台**：部署过程因您选择的托管平台而异。以下是一些流行平台的常规指南：

    *   **Vercel**：
        1.  将您的项目推送到 GitHub 存储库。
        2.  将您的 Vercel 帐户与您的 GitHub 帐户相关联。
        3.  从您的 Vercel 仪表板导入您的 GitHub 存储库。
        4.  将构建命令配置为 `npm run build`，将发布目录配置为 `dist`。
        5.  Vercel 将自动构建和部署您的应用程序。

    *   **Netlify**：
        1.  将您的项目推送到 GitHub 存储库。
        2.  将您的 Netlify 帐户与您的 GitHub 帐户相关联。
        3.  从您的 Netlify 仪表板创建一个新站点并选择您的 GitHub 存储库。
        4.  将构建命令配置为 `npm run build`，将发布目录配置为 `dist`。
        5.  Netlify 将自动构建和部署您的应用程序。

    *   **GitHub Pages**：
        1.  将您的项目推送到 GitHub 存储库。
        2.  在您的 `vite.config.ts` 文件中，将 `base` 选项设置为您的存储库名称（例如 `/my-repo/`）。
        3.  使用 `npm run build` 构建您的应用程序。
        4.  将 `dist` 目录的内容推送到您存储库的 `gh-pages` 分支。
        5.  在您的存储库设置中，将 GitHub Pages 源配置为 `gh-pages` 分支。

## 开发人员入门

本节专为有兴趣为 Mirage 镜像站项目做出贡献的开发人员而设计。无论您是想修复错误、添加新功能还是改进文档，本指南都将帮助您入门。

### 设置您的开发环境

1.  **复刻和克隆存储库**：首先，在 GitHub 上复刻项目存储库。然后，将您复刻的存储库克隆到您的本地计算机：
    ```bash
    git clone https://github.com/YOUR_USERNAME/mirage-mirror.git
    ```
2.  **安装依赖项**：导航到项目目录并安装所需的依赖项：
    ```bash
    npm install
    ```
3.  **配置 API 密钥**：在项目目录中创建一个 `.env.local` 文件，并添加您的 Gemini API 密钥：
    ```
    GEMINI_API_KEY=YOUR_API_KEY
    ```
4.  **运行开发服务器**：启动开发服务器以在本地运行应用程序：
    ```bash
    npm run dev
    ```
    该应用程序现在应该可以在 `http://localhost:5173` 上访问。

### 行为准则

我们希望我们社区的所有成员都遵守我们的行为准则。请花点时间阅读它，以确保项目对每个人来说都是一个受欢迎和包容的环境。

### 贡献

我们欢迎以各种形式做出贡献，包括：

*   **错误报告**：如果您发现错误，请在 GitHub 问题中报告。请提供有关如何重现该错误的详细信息。
*   **功能请求**：如果您有新功能的想法，请在 GitHub 问题中提出。
*   **拉取请求**：如果您想为代码库做出贡献，请随时提交拉取请求。请确保您的代码符合项目的编码标准，并包含对您所做更改的清晰描述。

### 编码标准

为确保代码质量和一致性，我们遵循以下编码标准：

*   **TypeScript**：所有代码都应使用 TypeScript 编写。
*   **格式化**：我们使用 Prettier 进行代码格式化。请在提交代码之前确保您的代码已正确格式化。
*   **命名约定**：对变量、函数和组件使用清晰且具有描述性的名称。
*   **注释**：为复杂或不明显的代码添加注释。

我们很高兴看到您的贡献！
